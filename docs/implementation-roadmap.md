# 実装ロードマップ - ビジュアルガイド

このドキュメントは、こいこいルールエンジンの実装計画を視覚的に示したガイドです。

## 全体の流れ

```
仕様書の分析 → プロジェクトセットアップ → MVP開発 → 完全ルール → 拡張機能 → 最適化
    ✓              「プロジェクト構造とソリューションのセットアップ」           Phase 1    Phase 2     Phase 3     Phase 4
                                    (2-3週間)   (1-2週間)    (1週間)     (1週間)
```

## フェーズ1: 基本機能（MVP） - 2-3週間

```
┌─────────────────────────────────────────────────────────────────────┐
│                        フェーズ1: MVP                                │
│                    基本的なゲームが遊べる                              │
└─────────────────────────────────────────────────────────────────────┘

Week 1: 基盤構築
┌──────────────┐
│ セットアップ   │  ├─ ソリューション作成
└──────────────┘  ├─ 3つのプロジェクト
                  └─ テストプロジェクト

┌──────────────┐  ┌──────────────┐
│ データモデル   │  │ 状態管理     │
└──────────────┘  └──────────────┘
    │                  │
    v                  v
┌──────────────┐  ┌──────────────┐
│ 札の定義      │  │ 山札管理     │
└──────────────┘  └──────────────┘

Week 2: コアロジック
┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│ 役判定       │→ │ 得点計算     │  │ ターン進行    │
│ (基本役のみ)  │  │              │  │              │
└──────────────┘  └──────────────┘  └──────────────┘

Week 3: ゲーム統合
┌──────────────┐  ┌──────────────┐
│ アクション    │→ │ ファサード    │
└──────────────┘  └──────────────┘
                      │
                      v
┌──────────────┐  ┌──────────────┐
│ 配札・勝敗    │  │ 統合テスト    │ ← MVP完成！
└──────────────┘  └──────────────┘
```

### MVP完成時にできること
✓ 手札から札を出す
✓ 場の札を取得する
✓ 山札から引く
✓ 基本的な役を判定（光札、種、短冊、カス）
✓ 得点を計算
✓ 勝敗を決定
✓ ゲームを最後まで遊ぶ

### MVP完成時にできないこと
✗ こいこいの選択
✗ 喰い付き
✗ 特殊な役（猪鹿蝶、赤短など）
✗ カスタムルール

---

## フェーズ2: 完全なルール実装 - 1-2週間

```
┌─────────────────────────────────────────────────────────────────────┐
│                      フェーズ2: 完全ルール                            │
│                  本格的なこいこいが遊べる                              │
└─────────────────────────────────────────────────────────────────────┘

Week 4: こいこいと特殊ルール
┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│ こいこい      │  │ 喰い付き      │  │ 猪鹿蝶等     │
│              │  │              │  │ 花見・月見    │
└──────────────┘  └──────────────┘  └──────────────┘

┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│ 赤短・青短    │  │ 総流れ        │  │ 再配札       │
└──────────────┘  └──────────────┘  └──────────────┘
                                          │
                                          v
                                  ┌──────────────┐
                                  │ 統合テスト    │ ← 完全ルール完成！
                                  └──────────────┘

並行実装:
┌──────────────┐
│エラーハンドリング│
└──────────────┘
```

### フェーズ2完成時にできること
✓ こいこいを宣言して続行
✓ こいこいのリスクとリターン
✓ 喰い付きで4枚取得
✓ 全ての役を判定（12種類）
✓ 8ターンで総流れ（引き分け）
✓ 配札エラーで再配札

---

## フェーズ3: 拡張機能 - 1週間

```
┌─────────────────────────────────────────────────────────────────────┐
│                      フェーズ3: 拡張機能                              │
│                  カスタマイズとイベント                                │
└─────────────────────────────────────────────────────────────────────┘

Week 5: 拡張とカスタマイズ
┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│ 手四         │  │ ルール設定    │  │ イベント     │
│ (オプション)  │  │ カスタマイズ  │  │ システム     │
└──────────────┘  └──────────────┘  └──────────────┘
                                          │
                                          v
                                  ┌──────────────┐
                                  │ 統合テスト    │ ← 拡張機能完成！
                                  └──────────────┘
```

### フェーズ3完成時にできること
✓ 手四で役満勝ち（オプション）
✓ 役の得点をカスタマイズ
✓ こいこいの倍率変更
✓ ゲームイベントの記録と追跡

---

## フェーズ4: 高度な機能 - 1週間

```
┌─────────────────────────────────────────────────────────────────────┐
│                      フェーズ4: 高度な機能                            │
│                  最適化とプロダクション準備                            │
└─────────────────────────────────────────────────────────────────────┘

Week 6: 最適化と仕上げ
┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│ パフォーマンス │  │ 詳細ログ      │  │ リプレイ     │
│ 最適化       │  │ 機能         │  │ 機能         │
└──────────────┘  └──────────────┘  └──────────────┘
                                          │
                                          v
                                  ┌──────────────┐
                                  │ 最終調整     │ ← リリース準備完了！
                                  └──────────────┘

並行実装:
┌──────────────┐
│ APIドキュメント │
└──────────────┘
```

### フェーズ4完成時にできること
✓ 高速な役判定とゲーム進行
✓ 詳細なデバッグログ
✓ ゲームのリプレイと分析
✓ 完全なAPIドキュメント

---

## その他のタスク（いつでも実装可能）

```
┌──────────────┐
│ CI/CD設定    │  プロジェクト初期から並行実装推奨
└──────────────┘

┌──────────────┐
│エラーハンドリング│  フェーズ2で実装
└──────────────┘

┌──────────────┐
│ APIドキュメント │  フェーズ4で実装
└──────────────┘
```

---

## 依存関係の可視化

### クリティカルパス（最優先の実装順序）

```
┌──────┐    ┌──────┐    ┌──────┐    ┌──────┐    ┌──────┐    ┌──────┐
│構造  │ -> │データ│ -> │札定義│ -> │山札  │ -> │役判定│ -> │得点  │
└──────┘    └──────┘    └──────┘    └──────┘    └──────┘    └──────┘
  │                                                              │
  v                                                              v
┌──────┐    ┌──────┐    ┌──────┐    ┌──────┐    ┌──────┐    ┌──────┐
│状態  │ -> │ターン│ -> │動作  │ -> │外観  │ -> │配札  │ -> │統合  │
└──────┘    └──────┘    └──────┘    └──────┘    └──────┘    └──────┘
                                                                │
                                                                v
                                                            MVP完成
```

### 並行実装の例

```
Time ────────────────────────────────────────────────>

開発者A:  構造  →  データ  →  札  →  役判定  →  得点  →  統合
                                              
開発者B:       CI/CD →  状態  →  ターン  →  動作  →  外観  ↗

開発者C:            山札  →  配札  ────────────→  ↗
```

---

## マイルストーンと成果物

### M1: MVP完成（3週間後）

**成果物:**
- 動作するこいこいルールエンジン（基本機能のみ）
- ユニットテストスイート（カバレッジ70%以上）
- 基本的なドキュメント

**デモ可能な内容:**
- 札を配って手札を出す
- 場の札を取得する
- 基本的な役を判定する
- 得点を計算して勝敗を決める

---

### M2: 完全ルール実装（5週間後）

**成果物:**
- こいこいを含む完全なルールエンジン
- 全ての役判定（12種類）
- 特殊ルール（喰い付き、総流れ）
- ユニットテストスイート（カバレッジ80%以上）

**デモ可能な内容:**
- こいこいを宣言して続行
- 喰い付きで4枚取得
- 赤短、青短、猪鹿蝶などの特殊な役
- 8ターンで総流れ

---

### M3: 拡張機能実装（6週間後）

**成果物:**
- カスタマイズ可能なルールエンジン
- イベントシステム
- 手四のオプション実装
- ユニットテストスイート（カバレッジ85%以上）

**デモ可能な内容:**
- 役の得点をカスタマイズ
- ゲームイベントの記録
- 手四で役満勝ち（オプション）

---

### M4: リリース準備完了（7-8週間後）

**成果物:**
- 最適化されたルールエンジン
- リプレイ機能
- 詳細なログ機能
- 完全なAPIドキュメント
- ベンチマークレポート

**デモ可能な内容:**
- 高速なゲーム進行
- ゲームのリプレイと分析
- 詳細なデバッグ情報

---

## 推奨開発フロー

### 個人開発の場合

```
Week 1-3:  フェーズ1（MVP）に集中
           ↓
Week 4-5:  フェーズ2（完全ルール）に集中
           ↓
Week 6:    フェーズ3（拡張機能）に集中
           ↓
Week 7-8:  フェーズ4（最適化）に集中
```

### チーム開発の場合（3人）

```
メンバーA:  コアロジック担当
  Week 1-2: 「プロジェクト構造とソリューションのセットアップ」, 「Core層の基本データモデル実装」, 「札の定義と管理」, 「基本的な役判定の実装（光札、種、短冊、カス）」, 「得点計算機能の実装」
  Week 3-4: 「特殊な役の実装（猪鹿蝶、花見で一杯、月見で一杯）」, 「短冊の特殊役（赤短、青短）の実装」, 「ルール設定のカスタマイズ機能」
  Week 5-6: 「パフォーマンス最適化」, 「APIリファレンスの作成」

メンバーB:  ゲームフロー担当
  Week 1-2: 「ゲーム状態管理クラスの実装」, 「ターン進行の基本ロジック」, 「アクション定義とバリデーション」, 「ゲームファサードの実装」
  Week 3-4: 「こいこいの宣言と処理」, 「喰い付き（くいつき）の実装」, 「イベントシステムの実装」
  Week 5-6: 「詳細なログ機能」, 「リプレイ機能」

メンバーC:  インフラ・テスト担当
  Week 1-2: 「CI/CDの設定」, 「山札管理とシャッフル機能」, 「配札検証と勝敗判定」
  Week 3-4: 「総流れ（そうながれ）の実装」, 「配札の再検証機能」, 「エラーハンドリングの実装」
  Week 5-6: 「MVP統合テストとデバッグ」, 「フェーズ2統合テストとデバッグ」, 「フェーズ3統合テストとデバッグ」, 「フェーズ4統合テストと最終調整」
```

---

## 品質チェックポイント

### 各フェーズ完了時

- [ ] 全てのテストが成功
- [ ] コードカバレッジが基準を満たす
- [ ] ドキュメントが更新されている
- [ ] CI/CDパイプラインが成功
- [ ] コードレビューが完了

### リリース前

- [ ] 全機能の動作確認
- [ ] パフォーマンステスト実施
- [ ] セキュリティチェック
- [ ] APIドキュメント完成
- [ ] リリースノート作成

---

**作成日**: 2025-11-17  
**バージョン**: 1.0
